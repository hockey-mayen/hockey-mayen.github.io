async function loadChronik(){const e=await fetch("/assets/data/chronik.json"),t=await e.json(),n=document.getElementById("timeline"),s=document.getElementById("year-column-left"),i=document.getElementById("year-column-right"),a=document.getElementById("year-dropdown"),r=t.events.map(e=>e.year),o=Math.ceil(r.length/2),l=r.slice(0,o),d=r.slice(o).reverse();t.events.forEach(e=>{let t=document.createElement("div");t.className="year-heading",t.id=`year-${e.year}`,t.textContent=e.year,n.appendChild(t);let s=document.createElement("ul");s.className="event-list",e.entries.forEach(e=>{let t=document.createElement("li");t.className="event-item";let n=e.event.length>450,i=e.event,a=e.event;if(n){let t=e.event.substring(0,450),n=t.lastIndexOf(" ");n>-1&&(i=t.substring(0,n)),i+=" ..."}let r=`<div class="event-details">\n                                    <span class="event-item-headline">${e.headline}</span>\n                                    <span class="event-text short-text">${i}</span>\n                                    <span class="event-text full-text" style="display: none;">${a}</span>`;n&&(r+='<a href="#" class="toggle-text">Weiterlesen</a>'),e.images&&e.images.length>0&&(r+='<div class="event-gallery">',e.images.forEach(e=>{r+=`<div class="event-image"><img src="${e}" alt="Event Image"></div>`}),r+="</div>"),e.link&&e.linkTitle&&(r+=`<div class="event-link">\n                                    <a href="${e.link}" target="_blank">${e.linkTitle}</a>\n                                </div>`),r+="</div>",t.innerHTML=r,s.appendChild(t)}),n.appendChild(s)}),l.forEach(e=>{let t=document.createElement("button");t.className="year-button",t.textContent=e,t.setAttribute("data-year",e),t.onclick=()=>fadeToYear(e),s.appendChild(t)}),d.forEach(e=>{let t=document.createElement("button");t.className="year-button",t.textContent=e,t.setAttribute("data-year",e),t.onclick=()=>fadeToYear(e),i.appendChild(t)}),r.forEach(e=>{let t=document.createElement("option");t.value=e,t.textContent=e,a.appendChild(t)}),a.addEventListener("change",function(){fadeToYear(this.value)}),document.querySelector(`.year-button[data-year='${r[0]}']`).classList.add("active"),document.querySelectorAll(".toggle-text").forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=this.parentElement,n=t.querySelector(".short-text"),s=t.querySelector(".full-text");"none"===n.style.display?(n.style.display="inline",s.style.display="none",this.textContent="Weiterlesen"):(n.style.display="none",s.style.display="inline",this.textContent="Weniger anzeigen")})}),window.addEventListener("scroll",highlightCurrentYear)}function fadeToYear(e){const t=document.getElementById("timeline"),n=document.getElementById(`year-${e}`);n&&(t.style.transition="opacity 0.4s ease-in-out",t.style.opacity="0.0",setTimeout(()=>{window.scrollTo({top:n.offsetTop-100,behavior:"instant"}),t.style.transition="opacity 0.6s ease-in-out",t.style.opacity="1",document.querySelectorAll(".year-button").forEach(e=>e.classList.remove("active")),document.querySelector(`.year-button[data-year='${e}']`)?.classList.add("active")},400))}function highlightCurrentYear(){let e=document.querySelectorAll(".year-heading"),t=window.scrollY+200,n=null;if(e.forEach(e=>{e.offsetTop<=t&&(n=e.id.replace("year-",""))}),n){document.querySelectorAll(".year-button").forEach(e=>e.classList.remove("active"));let e=document.querySelector(`.year-button[data-year='${n}']`);e&&e.classList.add("active")}}function toggleCollapsible(){let e=document.querySelector(".collapsible-content"),t=document.querySelector(".arrow");"block"===e.style.display?(e.style.display="none",t.innerHTML="&#9654;"):(e.style.display="block",t.innerHTML="&#9660;")}document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("scrollTopBtn");window.addEventListener("scroll",function(){window.scrollY>100?e.classList.add("show"):e.classList.remove("show")}),window.scrollToTop=function(){window.scrollTo({top:0,behavior:"smooth"})}}),document.addEventListener("DOMContentLoaded",async function(){const e=document.querySelector(".tile-aktuell");if(!e)return;const t=document.createElement("div");t.classList.add("event-container");const n=document.createElement("div");n.classList.add("event-nav-container");const s=document.createElement("div");s.classList.add("event-download-container");const i=document.createElement("img");i.classList.add("event-download"),i.src="/assets/images/download-button.png",i.alt="Download";const a=document.createElement("a");a.setAttribute("download",""),a.appendChild(i),s.appendChild(a);const r=document.createElement("button");r.classList.add("event-nav","left"),r.innerHTML="&lt;";const o=document.createElement("button");o.classList.add("event-nav","right"),o.innerHTML="&gt;";const l=document.createElement("img");l.classList.add("event-image");const d=document.createElement("div");d.classList.add("event-dots");let c=[],u=0;try{const p=await fetch("/assets/data/events.json");if(c=await p.json(),0===c.length)throw new Error("Keine Events gefunden.");function g(){const e=c[u].image;l.src=e,l.alt=c[u].title;const t=e.replace("-web","").replace("/web/","/").replace(".webp",".png");a.href=t,document.querySelectorAll(".dot").forEach((e,t)=>{e.classList.toggle("active",t===u)})}c.forEach((e,t)=>{const n=document.createElement("span");n.classList.add("dot"),0===t&&n.classList.add("active"),n.addEventListener("click",()=>{u=t,g()}),d.appendChild(n)}),r.addEventListener("click",function(){u=(u-1+c.length)%c.length,g()}),o.addEventListener("click",function(){u=(u+1)%c.length,g()}),g()}catch(h){console.error("Fehler beim Laden der Events:",h)}const m=document.createElement("div");m.classList.add("event-nav-group"),m.appendChild(s),m.appendChild(r),m.appendChild(d),m.appendChild(o),n.appendChild(m),e.appendChild(n),e.appendChild(t),t.appendChild(l)}),document.addEventListener("DOMContentLoaded",async function(){const e=document.getElementById("chronik-list"),t=document.createElement("button");t.textContent="Mehr anzeigen",t.classList.add("load-more-btn");let n=[],s=0;e.addEventListener("click",e=>{const t=e.target.closest(".toggle-text");if(!t)return;e.preventDefault();const n=t.parentElement,s=n.querySelector(".short-text"),i=n.querySelector(".full-text"),a="none"===s.style.display;s.style.display=a?"inline":"none",i.style.display=a?"none":"inline",t.textContent=a?"Weiterlesen":"Weniger anzeigen"});try{const a=await fetch("/assets/data/chronik.json");function i(){const i=n.slice(s,s+3),a=0===s;i.forEach((t,n)=>{const s=document.createElement("div");s.classList.add("chronik-entry");const i=t.event||"",r=i.length>450;let o=i,l=i;if(r){let e=i.substring(0,450),t=e.lastIndexOf(" ");t>-1&&(o=e.substring(0,t)),o+=" ..."}const d=t.images&&t.images.length>0?`<div class="chronik-images">\n                ${t.images.map((e,s)=>{const i=a&&0===n&&0===s,r=i?"eager":"lazy",o=i?"high":"low";return`<img src="${e}"\n                                 alt="Bild zu ${t.headline}"\n                                 loading="${r}"\n                                 decoding="async"\n                                 fetchpriority="${o}">`}).join("")}\n               </div>`:"",c=t.link?`<div class="event-link">\n               <a href="${t.link}" target="_blank" rel="noopener noreferrer">\n                 ${t.linkTitle||"Mehr erfahren"}\n               </a>\n             </div>`:"",u=`\n          <h2>${t.headline}</h2>\n          <p>\n            <span class="short-text">${o}</span>\n            <span class="full-text" style="display: none;">${l}</span>\n            ${r?'<a href="#" class="toggle-text">Weiterlesen</a>':""}\n          </p>\n          ${d}\n          ${c}\n        `;s.innerHTML=u,e.appendChild(s)}),s+=3,s>=n.length&&(t.style.display="none")}(await a.json()).events.forEach(e=>{n=n.concat(e.entries)}),n.sort((e,t)=>new Date(t.date||t.headline)-new Date(e.date||e.headline)),i(),t.addEventListener("click",i),e.parentNode.appendChild(t)}catch(r){console.error("Fehler beim Laden der Chronik:",r)}}),document.addEventListener("DOMContentLoaded",function(){let e=document.querySelector(".training-image-container");if(!e)return void console.error("Fehler: .training-image-container nicht gefunden!");let t=["/assets/images/training/training1.webp","/assets/images/training/training2.webp","/assets/images/training/training3.webp","/assets/images/training/training4.webp","/assets/images/training/training5.webp","/assets/images/training/training6.webp","/assets/images/training/training7.webp","/assets/images/training/training8.webp","/assets/images/training/training9.webp","/assets/images/training/training11.webp","/assets/images/training/training12.webp","/assets/images/training/training13.webp","/assets/images/training/training14.webp","/assets/images/training/training15.webp","/assets/images/training/training16.webp","/assets/images/training/training17.webp","/assets/images/training/training18.webp","/assets/images/training/training19.webp","/assets/images/training/training20.webp","/assets/images/training/training21.webp","/assets/images/training/training22.webp","/assets/images/training/training23.webp","/assets/images/training/training24.webp","/assets/images/training/training25.webp","/assets/images/training/training26.webp","/assets/images/training/training27.webp","/assets/images/training/training28.webp","/assets/images/training/training29.webp"],n=Math.floor(Math.random()*t.length),s=(n+1)%t.length,i=document.createElement("img"),a=document.createElement("img");i.src=t[n],i.classList.add("active"),a.src=t[s],e.appendChild(i),e.appendChild(a);let r=document.createElement("div");r.classList.add("progress-bar"),e.appendChild(r),console.log("Progress-Bar wurde hinzugefügt:",r);let o=!1;function l(){r.style.width="0%",r.style.transition="none",setTimeout(()=>{r.style.transition="width 10s linear",r.style.width="100%"},50)}setInterval(function(){r.style.transition="none",r.style.width="0%",o||(o=!0,i.classList.remove("active"),a.classList.add("active"),setTimeout(()=>{n=(n+1)%t.length,s=(n+1)%t.length,i.src=t[s],i.classList.add("fade"),a.classList.remove("fade"),[i,a]=[a,i],o=!1,l()},3e3))},13e3),l()}),document.addEventListener("DOMContentLoaded",function(){let e=document.querySelector(".turniere-image-container");if(!e)return void console.error("Fehler: .turniere-image-container nicht gefunden!");let t=["/assets/images/turniere/turnier1.webp","/assets/images/turniere/turnier2.webp","/assets/images/turniere/turnier3.webp","/assets/images/turniere/turnier4.webp","/assets/images/turniere/turnier5.webp","/assets/images/turniere/turnier6.webp","/assets/images/turniere/turnier7.webp","/assets/images/turniere/turnier8.webp","/assets/images/turniere/turnier9.webp","/assets/images/turniere/turnier10.webp","/assets/images/turniere/turnier11.webp","/assets/images/turniere/turnier12.webp","/assets/images/turniere/turnier13.webp","/assets/images/turniere/turnier14.webp","/assets/images/turniere/turnier15.webp","/assets/images/turniere/turnier16.webp","/assets/images/turniere/turnier17.webp","/assets/images/turniere/turnier18.webp","/assets/images/turniere/turnier19.webp","/assets/images/turniere/turnier20.webp","/assets/images/turniere/turnier21.webp","/assets/images/turniere/turnier22.webp","/assets/images/turniere/turnier23.webp","/assets/images/turniere/turnier24.webp","/assets/images/turniere/turnier25.webp","/assets/images/turniere/turnier26.webp","/assets/images/turniere/turnier27.webp","/assets/images/turniere/turnier28.webp","/assets/images/turniere/turnier29.webp","/assets/images/turniere/turnier30.webp","/assets/images/turniere/turnier31.webp","/assets/images/turniere/turnier32.webp","/assets/images/turniere/turnier33.webp","/assets/images/turniere/turnier34.webp","/assets/images/turniere/turnier35.webp","/assets/images/turniere/turnier36.webp","/assets/images/turniere/turnier37.webp","/assets/images/turniere/turnier38.webp","/assets/images/turniere/turnier39.webp","/assets/images/turniere/turnier40.webp","/assets/images/turniere/turnier41.webp","/assets/images/turniere/turnier42.webp"],n=Math.floor(Math.random()*t.length),s=(n+1)%t.length,i=document.createElement("img"),a=document.createElement("img");i.src=t[n],i.classList.add("active"),a.src=t[s],e.appendChild(i),e.appendChild(a);let r=document.createElement("div");r.classList.add("progress-bar"),e.appendChild(r),console.log("Progress-Bar wurde hinzugefügt:",r);let o=!1;function l(){r.style.width="0%",r.style.transition="none",setTimeout(()=>{r.style.transition="width 10s linear",r.style.width="100%"},50)}setInterval(function(){r.style.transition="none",r.style.width="0%",o||(o=!0,i.classList.remove("active"),a.classList.add("active"),setTimeout(()=>{n=(n+1)%t.length,s=(n+1)%t.length,i.src=t[s],i.classList.add("fade"),a.classList.remove("fade"),[i,a]=[a,i],o=!1,l()},3e3))},13e3),l()}),document.addEventListener("DOMContentLoaded",loadChronik),document.addEventListener("DOMContentLoaded",function(){let e=document.querySelector(".kontakt-container");e?window.innerWidth<1025&&setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"start"})},300):console.error("Fehler: .kontakt-container nicht gefunden!")}),document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".js-mail").forEach(e=>{const t=e.dataset.x;if(!t)return;let n;try{n=atob(t)}catch{return}e.textContent=n,e.href=`mailto:${n}`,e.target="_blank",e.rel="noopener"})}),document.addEventListener("DOMContentLoaded",()=>{const e={geschaeftsfuehrung:"Geschäftsführung",vorsitz:"Vorsitz",jugendwart:"Jugendwart",webmaster:"Webmaster"},t=document.getElementById("contactForm"),n=document.getElementById("recipient"),s=document.getElementById("name"),i=document.getElementById("email"),a=document.getElementById("phone"),r=document.getElementById("message"),o=document.getElementById("honeypot"),l=document.getElementById("submitBtn"),d=document.getElementById("formHint"),c=document.getElementById("recipientError"),u=document.getElementById("nameError"),g=document.getElementById("emailError"),m=document.getElementById("messageError"),p=document.getElementById("messageCounter"),h=document.getElementById("thankYouBox"),y=document.getElementById("summaryBox"),w=document.getElementById("turnstileError");let v="";window.onTurnstileSuccess=e=>{v=String(e||""),w&&(w.style.display="none"),k()},window.onTurnstileExpired=()=>{v="",k()},window.onTurnstileError=()=>{v="",w&&(w.style.display="block"),k()};const b=e=>String(e??"").trim(),f=e=>/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(String(e).trim());function E(e,t){e&&(e.style.display=t?"block":"none")}function L(e){l.disabled=!e,e?l.removeAttribute("disabled"):l.setAttribute("disabled","disabled")}function C(){const e=b(r.value).length;p&&(e>=20?(p.textContent=`${e}/20 Zeichen ✅`,p.style.color="#008f5a"):(p.textContent=`${e}/20 Zeichen (mindestens 20)`,p.style.color="#6c757d"))}function k(){const t=b(n.value),a=!!t,o=b(s.value),l=o.length>=2,p=b(i.value),h=f(p),y=b(r.value),w=y.length>=20,C=!!v;E(c,!a),E(u,o.length>0&&!l),E(g,p.length>0&&!h),E(m,y.length>0&&!w),d&&(d.textContent=a?`Empfänger: ${e[t]||t}`:"");const k=a&&l&&h&&w&&C;return L(k),k}function x(e){return String(e).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}n.addEventListener("change",k),s.addEventListener("input",k),i.addEventListener("input",k),a.addEventListener("input",k),r.addEventListener("input",()=>{C(),k()}),C(),L(!1),k(),t.addEventListener("submit",async d=>{if(d.preventDefault(),o&&b(o.value))return;if(!v)return w&&(w.textContent="Bitte bestätigen Sie kurz, dass Sie kein Bot sind.",w.style.display="block"),void k();if(!k())return;const c=b(n.value),u={honeypot:o?b(o.value):"",recipient:c,recipientLabel:e[c]||c,name:b(s.value),email:b(i.value),phone:b(a.value),message:b(r.value),turnstileToken:v};try{L(!1),l.textContent="Sende...";const e=await fetch("https://hockey-mayen-contact.sergej-schatz.workers.dev/?debug=1",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});let n=null;try{n=await e.json()}catch{}if(!e.ok||n&&!1===n.ok)throw 403===e.status&&(v="",w&&(w.textContent="Captcha ungültig/abgelaufen. Bitte erneut bestätigen.",w.style.display="block"),window.turnstile&&"function"==typeof window.turnstile.reset&&window.turnstile.reset()),new Error(`HTTP ${e.status} ${n?JSON.stringify(n):""}`);!function(e){const t=e.phone?`<div><strong>Telefon:</strong> ${x(e.phone)}</div>`:"";y.innerHTML=`\n      <div><strong>Ansprechpartner:</strong> ${x(e.recipientLabel)}</div>\n      <div><strong>Name:</strong> ${x(e.name)}</div>\n      <div><strong>E-Mail:</strong> ${x(e.email)}</div>\n      ${t}\n      <div style="margin-top:10px;"><strong>Nachricht:</strong></div>\n      <div style="white-space:pre-wrap;">${x(e.message)}</div>\n    `}(u),t.style.display="none",h.style.display="block"}catch(e){console.error(e),alert("Leider konnte die Nachricht nicht gesendet werden. Bitte versuchen Sie es später erneut."),l.textContent="Senden",C(),k()}})});